--- libpng-1.5.7/contrib/pngminus/makefile.std.orig	2011-12-15 16:45:32.000000000 +0100
+++ libpng-1.5.7/contrib/pngminus/makefile.std	2011-12-18 16:24:38.099367091 +0100
@@ -12,21 +12,21 @@
 #PNGLIB = -L$(PNGPATH)/lib -lpng16
 #PNGLIBS = $(PNGPATH)/lib/libpng16.a
 PNGINC = -I../..
-PNGLIB = -L../.. -lpng
+PNGLIB = -L../.. -L../../.libs -lpng16
 PNGLIBS = ../../libpng.a
 
 #ZPATH = /usr/local
 #ZINC = -I$(ZPATH)/include
 #ZLIB = -L$(ZPATH)/lib -lz
 #ZLIBS = $(ZPATH)/lib/libz.a
-ZINC = -I../../../zlib
-ZLIB = -L../../../zlib -lz
-ZLIBS = ../../../zlib/libz.a
+ZINC =
+ZLIB = -lz
+ZLIBS = -lz
 
-CPPFLAGS=$(PNGINC) $(ZINC)
+CPPFLAGS=$(OPT_FLAGS) $(PNGINC) $(ZINC)
 CFLAGS=
 LDLIBS=$(PNGLIB) $(ZLIB)
-LDLIBSS=$(PNGLIBS) $(ZLIBS)
+LDLIBSS=$(LD_FLAGS) $(PNGLIBS) $(ZLIBS)
 C=.c
 O=.o
 L=.a
@@ -33,8 +33,7 @@
 
 # dependencies
 
-#all: png2pnm$(E) pnm2png$(E)
-all: png2pnm$(E) pnm2png$(E) png2pnm-static$(E) pnm2png-static$(E)
+all: png2pnm$(E) pnm2png$(E)
 
 png2pnm$(O): png2pnm$(C)
 	$(CC) -c $(CFLAGS) png2pnm$(C)
--- libpng-1.6.32/contrib/pngminus/pnm2png.c~	2017-08-24 21:44:51.000000000 +0200
+++ libpng-1.6.32/contrib/pngminus/pnm2png.c	2017-10-22 11:21:14.284686698 +0200
@@ -376,7 +376,7 @@ BOOL pnm2png (FILE *pnm_file, FILE *png_
   /* row_bytes is the width x number of channels x (bit-depth / 8) */
     row_bytes = width * channels * ((bit_depth <= 8) ? 1 : 2);
 
-  if ((row_bytes == 0 || (size_t)height > ((size_t)(-1))/(size_t)row_bytes)
+  if ((row_bytes == 0 || (size_t)height > ((size_t)(-1))/(size_t)row_bytes))
   {
     /* too big */ 
     return FALSE;
--- libpng-1.6.32/contrib/pngminus/png2pnm.c~	2017-08-24 21:44:51.000000000 +0200
+++ libpng-1.6.32/contrib/pngminus/png2pnm.c	2017-10-22 11:25:16.018590786 +0200
@@ -443,7 +443,7 @@ BOOL png2pnm (FILE *png_file, FILE *pnm_
   if (png_pixels != (unsigned char*) NULL)
     free (png_pixels);
 
-  PNG_UNUSED(raw) /* to quiet a Coverity defect */
+  
   return TRUE;
 
 } /* end of source */
--- libpng-1.6.32/contrib/pngminus/pnm2png.c~	2017-10-22 11:26:20.000000000 +0200
+++ libpng-1.6.32/contrib/pngminus/pnm2png.c	2017-10-22 11:26:43.537683599 +0200
@@ -513,7 +513,6 @@ BOOL pnm2png (FILE *pnm_file, FILE *png_
   if (png_pixels != (unsigned char*) NULL)
     free (png_pixels);
 
-  PNG_UNUSED(raw) /* Quiet a Coverity defect */
 
   return TRUE;
 } /* end of pnm2png */
